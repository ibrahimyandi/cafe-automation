{"version":3,"sources":["webpack:///src/app/views/cafe1/sales/sales.module.ts","webpack:///src/app/views/cafe1/sales/sales.component.html","webpack:///src/app/views/cafe1/sales/sales.component.ts","webpack:///src/app/views/cafe1/sales/sales-routing.module.ts"],"names":["SalesModule","window","print","imports","forRoot","declarations","SalesComponent","db","auth","router","groups","products","totalPrice","selectedProd","selectExist","stockDetail","exist","receiptExists","onAuthStateChanged","user","email","navigate","list","valueChanges","subscribe","i","sort","a","b","name","snapshotChanges","forEach","x","database","ref","once","then","snapshot","exists","receiptId","val","id","set","index","count","data","kdvPrice","splice","length","key","iter","element","payload","cafe1Stock","push","date","Date","faturaTarih","toLocaleString","newWin","open","document","write","toFixed","sellStock","parseFloat","update","cafeStock","undefined","stock","average","amount","cost","process","group","close","alinanPara","selector","template","routes","path","component","title","salesRoutingModule","forChild","exports"],"mappings":"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","file":"views-cafe1-sales-sales-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { ChartsModule } from 'ng2-charts';\r\nimport { BsDropdownModule } from 'ngx-bootstrap/dropdown';\r\nimport { ButtonsModule } from 'ngx-bootstrap/buttons';\r\nimport { TabsModule } from 'ngx-bootstrap/tabs';\r\n\r\nimport { SalesComponent } from './sales.component';\r\nimport { salesRoutingModule } from './sales-routing.module';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n@NgModule({\r\n  imports: [\r\n    FormsModule,\r\n    salesRoutingModule,\r\n    ChartsModule,\r\n    BsDropdownModule,\r\n    TabsModule,\r\n    ButtonsModule.forRoot(),\r\n    CommonModule\r\n  ],\r\n  declarations: [ SalesComponent ]\r\n})\r\nexport class SalesModule {\r\n\r\n  sell(){\r\n    window.print();\r\n  }\r\n  cancel(){\r\n    \r\n  }\r\n}\r\n","export default \"<div class=\\\"animated fadeIn\\\">\\r\\n    <div class=\\\"row\\\">\\r\\n      <div class=\\\"col-md-9\\\">\\r\\n        <tabset>\\r\\n          <ng-container *ngFor=\\\"let group of groups\\\">\\r\\n            <tab heading=\\\"{{group.name}}\\\">\\r\\n              <div class=\\\"row\\\">\\r\\n                <div *ngFor=\\\"let prod of products\\\">\\r\\n                  <div class=\\\"float-left\\\" *ngIf=\\\"group.name == prod.payload.val().group && prod.payload.val().cafe1Stock > 0\\\" (click)=\\\"selectProduct(prod.key)\\\">\\r\\n                    <div class=\\\"card\\\" style=\\\"cursor: pointer;\\\">\\r\\n                      <div class=\\\"body\\\">\\r\\n                        <img style=\\\"width: 128px;height: 128px;\\\" src=\\\"{{prod.payload.val().photo}}\\\" class=\\\"rounded float-left\\\" alt=\\\"...\\\">\\r\\n                      </div>\\r\\n                      <div class=\\\"footer\\\" style=\\\"text-align: center;\\\">\\r\\n                        {{ prod.payload.val().name }} ({{ prod.payload.val().cafe1Stock | number : '.2-2' }})\\r\\n                      </div>  \\r\\n                    </div>\\r\\n                  </div>\\r\\n                </div>\\r\\n              </div>\\r\\n            </tab>\\r\\n          </ng-container>\\r\\n        </tabset>\\r\\n      </div>\\r\\n      <div class=\\\"col-md-3\\\">\\r\\n        <div class=\\\"card\\\">\\r\\n          <div class=\\\"card-header\\\">\\r\\n            <i class=\\\"cil-cash\\\"></i> Satılacaklar\\r\\n          </div>\\r\\n          <div class=\\\"card-body\\\">\\r\\n            <div class=\\\"row\\\" id=\\\"printTable\\\">\\r\\n              <table class=\\\"table table-bordered table-striped table-sm\\\" *ngIf=\\\"selectedProd.length > 0\\\">\\r\\n                <thead>\\r\\n                  <tr>\\r\\n                    <th></th>\\r\\n                    <th>Ürün adı</th>\\r\\n                    <th>Adet</th>\\r\\n                    <th>Fiyat</th>\\r\\n                  </tr>\\r\\n                </thead>\\r\\n                <tbody>\\r\\n                  <tr *ngFor=\\\"let item of selectedProd, let i = index\\\">\\r\\n                    <td (click)=\\\"countDecrease(i)\\\" style=\\\"display: table-cell;vertical-align: middle;cursor: pointer;text-align: center;\\\"><i class=\\\"cil-minus\\\" style=\\\"color:red\\\"></i></td>\\r\\n                    <td>{{item.data.name}}</td>\\r\\n                    <td>{{item.count}}</td>\\r\\n                    <td>{{item.totalPrice | number : '.2-2' }}</td>\\r\\n                  </tr>\\r\\n                </tbody>\\r\\n              </table>\\r\\n            </div>\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <label>Toplam tutar: </label>\\r\\n              </div>\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <label>{{totalPrice | number : '.2-2' }}</label>\\r\\n              </div>\\r\\n            </div>\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <label>Alınan para: </label>\\r\\n              </div>\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <div class=\\\"input-prepend input-group\\\">\\r\\n                  <div class=\\\"input-group-prepend\\\">\\r\\n                    <span class=\\\"input-group-text\\\"> ₺</span>\\r\\n                  </div>\\r\\n                  <input id=\\\"appendedPrependedInput\\\" class=\\\"form-control\\\" size=\\\"16\\\" type=\\\"number\\\" placeholder=\\\"0\\\" name=\\\"alinanPara\\\" [(ngModel)]=\\\"alinanPara\\\">\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <label>Para üstü: </label>\\r\\n              </div>\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <label *ngIf=\\\"alinanPara-this.totalPrice<0\\\">Eksik para verildi.</label>\\r\\n                <label *ngIf=\\\"alinanPara-this.totalPrice>0\\\">{{alinanPara-totalPrice | number : '.2-2' }} ₺</label>\\r\\n                <label *ngIf=\\\"alinanPara-this.totalPrice==0\\\">Ödendi</label>\\r\\n              </div>\\r\\n            </div>\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <button (click)=\\\"sell()\\\" type=\\\"button\\\" class=\\\"btn btn-success btn-square btn-block\\\" [disabled]=\\\"this.totalPrice==0\\\">SAT</button>\\r\\n              </div>\\r\\n              <div class=\\\"col-6\\\">\\r\\n                <button (click)=\\\"cancel()\\\" type=\\\"button\\\" class=\\\"btn btn-danger btn-square btn-block\\\">VAZGEÇ</button>\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\";","import { Component, OnInit } from '@angular/core';\r\nimport { AngularFireDatabase } from '@angular/fire/database';\r\nimport { AngularFireAuth } from '@angular/fire/auth';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-sales',\r\n  templateUrl: './sales.component.html',\r\n})\r\nexport class SalesComponent implements OnInit {\r\n  groups = [];\r\n  products =[];\r\n  group;\r\n  name;\r\n  photo;\r\n  price;\r\n  stocks;\r\n  totalPrice = 0;\r\n  alinanPara;\r\n  datestring;\r\n\r\n  selectedProd = [];\r\n  selectExist =[];\r\n  stockDetail = [];\r\n  \r\n  exist = false;\r\n  faturaTarih;\r\n  receiptId;\r\n  cost;\r\n  kdvPrice;\r\n  receiptExists = false;\r\n  ngOnInit(){}\r\n  \r\n  constructor(private db:AngularFireDatabase,auth:AngularFireAuth,private router:Router){\r\n    auth.onAuthStateChanged((user)=>{\r\n      if(user){\r\n        if((user.email == \"cafe1@sks.com\" || user.email == \"admin@sks.com\") == false){\r\n          router.navigate([\"/stock\"]);\r\n        }\r\n      }\r\n    })\r\n    db.list('/groups').valueChanges().subscribe(i => {\r\n      this.groups = i;\r\n      this.groups.sort((a, b) => {\r\n        if (a.name < b.name) return -1\r\n        return a.name > b.name ? 1 : 0\r\n      })\r\n    });\r\n    \r\n    db.list(\"/products\").snapshotChanges().forEach(i=>{\r\n      this.products = i;\r\n    });\r\n    this.db.list(\"receipt\").valueChanges().subscribe(x=>{\r\n      this.db.database.ref(\"receipt\").once('value').then(snapshot=>{\r\n        if(snapshot.exists()){\r\n          this.receiptId = snapshot.val().id;\r\n        }\r\n        else{\r\n          this.db.list(\"/receipt\").set('id',0); \r\n        }\r\n      });\r\n    })\r\n    \r\n  }\r\n  countDecrease(index){\r\n    this.selectedProd[index].count--;\r\n    this.totalPrice -= this.selectedProd[index].data.kdvPrice;\r\n    if(this.selectedProd[index].count<=0){\r\n      this.selectedProd.splice(index,1);\r\n    }\r\n    else{\r\n      this.selectedProd[index].totalPrice = this.selectedProd[index].count * this.selectedProd[index].data.kdvPrice;\r\n    }\r\n    if(this.selectedProd.length == 0)\r\n      this.totalPrice = 0;\r\n  }\r\n  selectProduct(key){\r\n    var iter = 0;\r\n    this.selectedProd.forEach(i=>{\r\n      this.products.forEach(element => {\r\n        if(key == i.key && element.key == key){\r\n          if(element.payload.val().cafe1Stock > this.selectedProd[iter].count){\r\n            this.selectedProd[iter].count += 1;\r\n            this.selectedProd[iter].totalPrice = this.selectedProd[iter].count * this.selectedProd[iter].data.kdvPrice;\r\n            this.totalPrice += this.selectedProd[iter].data.kdvPrice;\r\n          }\r\n          this.exist = true;\r\n        }\r\n      });\r\n      iter++;\r\n    })\r\n    if(this.exist==false){\r\n      this.products.forEach(element => { //TODO path ile veri ulaş.\r\n        \r\n        if(key == element.key){\r\n          this.selectedProd.push({data:element.payload.val(), count:1, key:element.key, totalPrice: element.payload.val().kdvPrice,date:0});\r\n          this.totalPrice += element.payload.val().kdvPrice;\r\n        }\r\n      });\r\n    }\r\n    this.exist = false;\r\n  }\r\n  key;\r\n  sellCount;\r\n  sell(){\r\n    this.totalPrice = 0;\r\n    const date = new Date();\r\n    this.faturaTarih = date.toLocaleString('tr-TR');\r\n    this.receiptId++;\r\n    var newWin = window.open(\"\");\r\n    newWin.document.write(\"<!DOCTYPE html><html lang='en'> <head> <meta charset='utf-8'> <title>SKS Fatura</title> <style> body{ width: 80mm; position: relative; display: block; margin: 0px; font-size: 12px; font-weight: bold; text-transform: uppercase; } .container{ margin: 10px; } .title{ text-align: center; margin-top: 4px; } span{ width: 100px; display: inline-block; } hr.dashed { border-top: 1px dashed black; } th{ width: 80px; text-align: left; } .bodyFooter{ position: relative; } .totalText{ width: 81%; } .total{ float: right; width: 19%; } .footer{ } </style> </head> <body> <div class='container'> <div class='head'> <div class='title'>SKS</div> <br> <div><span>PEŞİN MÜŞTERİ</span>&nbsp;&nbsp;</div>\");\r\n    newWin.document.write(\"</div> <div><span>TARİH</span>:&nbsp;&nbsp;\"+this.faturaTarih+\"</div><div><span>FİŞ NO</span>:&nbsp;&nbsp;\"+this.receiptId+\"</div> </div> <hr class='dashed'> <div class='body'> <table> <tr> <th style='width: 40%;'>ÜRÜN ADI</th> <th style='width: 0px;'></th><th style='width: 0px;'></th> <th>FİYAT</th> <th>ADET</th> <th>TUTAR</th> </tr>\")\r\n      this.selectedProd.forEach(x=>{\r\n      this.totalPrice += x.totalPrice;\r\n      newWin.document.write(\"<tr>\");\r\n      newWin.document.write(\"<td colspan='3'>\"+x.data.name+\"</td>\");\r\n      newWin.document.write(\"<td>\"+x.data.kdvPrice.toFixed(2)+\"&nbsp;₺</td>\");\r\n      newWin.document.write(\"<td>\"+x.count+\"</td>\");\r\n      newWin.document.write(\"<td>\"+x.totalPrice.toFixed(2)+\"&nbsp;₺</td>\");\r\n      newWin.document.write(\"</tr>\");\r\n      x.date = this.faturaTarih;\r\n      var sellStock = parseFloat(x.data.cafe1Stock) - parseFloat(x.count);\r\n      this.db.database.ref(\"/products/\"+x.key).update({cafe1Stock:sellStock});\r\n      //\r\n      this.products.forEach(element=>{\r\n        if(x.key == element.key){\r\n          var cafeStock = x.count;\r\n          this.stockDetail = element.payload.val().stockDetail;\r\n          if(element.payload.val().stockDetail != undefined){\r\n            for (let index = 0; index < this.stockDetail.length; index++) {\r\n              this.stockDetail[index].stock -= cafeStock;\r\n              if(this.stockDetail[index].stock > 0){\r\n                break;\r\n              }\r\n              else if(this.stockDetail[index].stock == 0){\r\n                break;\r\n              }\r\n              else{\r\n                cafeStock = -1 * this.stockDetail[index].stock;  \r\n              }\r\n            }  \r\n          }\r\n          var iter = 0;\r\n          this.stockDetail.forEach(i=>{\r\n            if(i.stock <= 0){\r\n              this.stockDetail.splice(iter, 1);\r\n            }\r\n            iter++;\r\n          })\r\n          if(this.stockDetail.length > 0){\r\n            var average = 0;\r\n            var amount = 0;\r\n            this.stockDetail.forEach(element => {\r\n              average += element.cost * element.stock;\r\n              amount += element.stock;\r\n            });\r\n            average = average / amount;\r\n            this.db.database.ref(\"/products/\"+x.key).update({cost: average, stockDetail:this.stockDetail});\r\n          }\r\n          else if(this.stockDetail.length == 1){\r\n            this.db.database.ref(\"/products/\"+x.key).update({cost: this.stockDetail[0].cost, stockDetail:this.stockDetail});\r\n          }\r\n          else{\r\n            this.db.database.ref(\"/products/\"+x.key).update({cost: 0, stockDetail:this.stockDetail});\r\n          }\r\n        }\r\n      })\r\n      //\r\n      this.db.list(\"/statistics/sold\").push({process:\"Kafe 1 satış\", name: x.data.name, group: x.data.group, kdvPrice: x.data.kdvPrice, cost: x.data.cost, count: x.count, date: x.date});\r\n    })\r\n    newWin.document.write(\"</table> <hr class='dashed'> <div class='bodyFooter'> <span class='totalText'>TOPLAM TUTAR</span>\");\r\n    newWin.document.write(\"<span class='total'>\"+this.totalPrice.toFixed(2)+\"&nbsp;₺</span>\");\r\n    newWin.document.write(\"</div> </div> <hr class='dashed'> <div class='footer'> </div> </div> </body></html>\");\r\n    newWin.print();  \r\n    newWin.close();\r\n    this.totalPrice = 0;  \r\n    this.selectedProd.splice(0,this.selectedProd.length);\r\n    this.db.list(\"/receipt\").set('id', this.receiptId);\r\n    this.alinanPara = 0;\r\n  }\r\n  cancel(){\r\n    this.selectedProd.splice(0,this.selectedProd.length);\r\n    this.totalPrice = 0;\r\n    this.alinanPara = 0;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { SalesComponent } from './sales.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: SalesComponent,\r\n    data: {\r\n      title: 'sales'\r\n    }\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class salesRoutingModule {}\r\n"]}